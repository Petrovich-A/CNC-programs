;detal 7556-1712212 korpus zolotnikov 
;OPER 150 **YSTANOV III KOLODCI!! BEZ ABM 1369***B0/B180/B270**G57*******
;STANOK nbh-6 INV.zav. A.10003135.02
;ROTKO A.A.          19.04.10
;TC=28_MIN 
DEF REAL POM_Y,FUS=3000,ZBEZ,ZPRIPUSK,XBEZ,YBEZ,ZAG,RO,Y_B180,X_B180,Z_B180,Y_B0,X_B0,Z_B0,Y_B270,X_B270,Z_B270,DPR,KP,TF,TS
;DEFINE SMENA_ZYX AS G75 FP=1 Z1=0 Y1=0 X1=0 SPOS=0  
DEFINE SMENA_Z AS g0 g53 z930 d0 m5 m9
$AC_TIMER[1]=0  ;cikl starta time/min
;**PERENOS S "OBKATKI"*R10(OS_X) R20(OS_Y)***
R40=(315-257.01+0.13)            ;OS_X  YSTANOV 3 X=315-257(257.72)
R50=175                   ;OS_Y  YSTANOV 3
R61=-315+365.09+0.085           ;OS_Z  YSTANOV 3 !!!B180!!!
R60=100-R61               ;OS_Z  YSTANOV 3 !!!B0!!!
GOTOF _proverka
START_1:
; ********rabota*********G57*****
;ST1: WORK_STEP(1)
;SMENA_Z
G0 G57 G17 G40 G90 G94          ;g57!!!!
;T="2.19" M6
;MSG("T2.19(2/19) FREZA D=125,WORK_STEP(1) ")
;************************************************ T2.19
;G0 g57 B0
;TRANS X=X_B0 Z=Z_B0 Y=Y_B0           ; B0!!!L5
;REGIME(80,125,7,0.127)
;G0 G56 X-148 Y137 D1 M3 
;Z0.5
;G1 Y30 F=r93 M8
;X71
;SMENA_Z
;G0 G57 B180
;TRANS X=X_B180 Z=Z_B180 Y=Y_B180    ; B180!!!L16
;G0 X-73 Y137 D1 M3 
;Z0.5
;G1 Y30 F=r93 M8
;X135
;SMENA_Z
ST1: WORK_STEP(1)
T="25.2" M6
MSG("T25.2(2/25)SVERLO D=33 INGEKTOR,WORK_STEP(1)")
;*************************************************** T4.1
G0 g57 B0
TRANS X=X_B0 Z=Z_B0 Y=Y_B0           ; B0_!!!L5
REGIME(125,33,1,0.1)
G0 G57 X87 Y35 D1 M3
MCALL CYCLE81(13,0,13,,91)
X87 Y35 M7 ;M8 
X29
X-29
X-87
X-145
MCALL
SMENA_Z
G0 G57 B180
TRANS X=X_B180 Z=Z_B180 Y=Y_B180    ; B180!!!L16
G0 X-87 Y35 D1 M3
MCALL CYCLE81(13,0,13,,91)
X-87 Y35 M7; M8 
X-29
X29
X87
X145
MCALL
SMENA_Z
ST2: WORK_STEP(2)
T="10.2" M6
MSG("T10.2(2/10)REZEC D=34.4+0.17  ,WORK_STEP(2)")
;*************************************************** T10.2
G0 G57 B180
TRANS X=X_B180 Z=Z_B180 Y=Y_B180    ; B180!!!L16
REGIME(65,34.3,1,0.15)
G0 G57 X-87 Y35 D1 M3
MCALL CYCLE81(5,0,5,,89.5)
X-87 Y35 M8 
X-29
X29
X87
X145
MCALL
SMENA_Z
G0 g57 B0
TRANS X=X_B0 Z=Z_B0 Y=Y_B0           ; B0!!!L5
G0 G57 X87 Y35 D1 M3 
Z3 M8
MCALL CYCLE81(3,0,3,,89.5)
X87 Y35
X29
X-29
X-87
X-145
MCALL
M5
SMENA_Z
ST3: WORK_STEP(3)
T="9.1" M6
MSG("T9.1(1/9)REZEC D=39.5 ,WORK_STEP(3)")
;*************************************************** T9.1
G0 G57 B180
TRANS X=X_B180 Z=Z_B180 Y=Y_B180    ; B180!!!L16
REGIME(80,39,1,0.12)
G0 G57 X29 Y35 D1 M3 
Z10 M8
CYCLE82(10,0,10,,20.5,1)
X145
CYCLE82(10,0,10,,33.5,1)
SMENA_Z
ST4: WORK_STEP(4)
T="7.2" M6 
MSG("T7.2(2/7)ZENKOVKA D=14<60,WORK_STEP(4)")
;*************************************************** T7.2
;N208 G0 G57 B0
;N209 TRANS X=X_B0 Z=Z_B0 Y=Y_B0    ; B0!!!L5
REGIME(32,10,4,0.085)  ; s1000
;N211 G0 G57 X-145 Y35 D1 M3 
;N212 ATRANS X-145
;N213 L9
;N214 ATRANS X58
;N215 L9
;N216 ATRANS X58
;N217 L9
;N218 ATRANS X58
;N219 L9
;N220 ATRANS X58
;N221 L9
;N222 ATRANS
;N223 G0 Z40 M9
SMENA_Z
G0 G57 B180
TRANS X=X_B180 Z=Z_B180 Y=Y_B180    ; B180!!!L16
G0 g57  X29 Y35 D1 M3
;G0 g57  X-87 Y35 D1 M3
;ATRANS X-87
;L9
;ATRANS X58
;L9
;ATRANS X116
;L9
ATRANS X29
L8
ATRANS X=145-29
L8
ATRANS
G0 Z40 M9
SMENA_Z

ST5: WORK_STEP(5)
T="22.2" M6
MSG("T22.2(2/22)RAZVERTKA D=40+0.062*NA L=28*,WORK_STEP(5)")
;*************************************************** T22.2
G0 G57 B180
TRANS X=X_B180 Z=Z_B180 Y=Y_B180    ; B180!!!L16
REGIME(10,40,8,0.07)
G0 G57 X145 Y35 D1 M3
Z8 M8
CYCLE85(28,0,8,,28,,40,200)
X29 Y35
CYCLE85(28,0,8,,15,,40,200)
SMENA_Z
;==========================================================

MSG("POLUCHI GOTOVUYU,GODNUYU DETAL.Nezabud podelitca!!!!")
;M0
;==========================================================
WORK_DONE
GOTOF _ENDE

ST999:TO_BROKEN
 _ENDE:T0 M6
M91
WORK_STEP(0)
; MSG("PIPEC PROGRAMME *** VSE DOMOY ***")
R98=$AC_TIMER[1]
;N68 R98=R98/60  ;cycle TIME/MIN
M30

_proverka:
;____3_ustanov___detal___storona B0/B180/B270____G57______
;*G57-X-centr STOLA,Y-PLOSKOST paleti,Z-centr STOLA
$P_UIFR[4]=CTRANS(X,0,Y,0,Z,0,B,180);  G57 B180
;N-PRISP.(7274-6070)
;NA PRISP.(7274-6070-22) R22=0
ZBEZ=3
XBEZ=10
YBEZ=7 
R22=0 
;______B0 __TRANS __________________     ;B0!!!L5!!
Y_B0=R50                ;OS_Y TRANS  
X_B0=-174+R40+116       ;OS_X TRANS bilo x=-174+57.857+116 (X-0.143) B0
Z_B0=R60+38.9             ;OS_Z TRANS bilo z=50+39-0.15=88.85
;_____B180__TRANS______________________   ;B180!!L16!!!
Y_B180=Y_B0             ;OS_Y TRANS
X_B180=174-R40-116      ;OS_X TRANS; bilo x=174-57.857-116 (x+0.143) B180
Z_B180=R61+38.9           ;OS_Z TRANS   ; bilo Z=50+39+0.05=89.05
;_____B270-TRANS X-10.95 Z=184.5 ;Z=186.5     ;B270!!L7!!
Y_B270=Y_B0                 ;OS_Y TRANS ;
X_B270=78-Z_B180            ;OS_X TRANS ; bilo X-10.95
Z_B270=116+69+1.5           ;OS_Z TRANS ; bilo Z=186.5

STOPRE
;**************************YSTANOV 3**********
;*poraydok obrabotki***metka***magazin/gnezdo*******NALADKA INSTRUMENTA******
 IF WORKING_STEP==0   GOTOF CHECK_1
 IF WORKING_STEP<=1   GOTOB ST1  ;T2.19(2/19)FREZA D=125/chern.
 M91 ;poka nezak-ca cmena palet 
 IF WORKING_STEP==2   GOTOB ST2  ;T4.1(1/4) SV. D=33 INGEKTOR
 IF WORKING_STEP==3   GOTOB ST3  ;T11.2(2/11)FREZA D=40
 IF WORKING_STEP==4   GOTOB ST4  ;T6.1(1/6) SVERLO D=16<90
 IF WORKING_STEP==5   GOTOB ST5  ;T1.2(2/1)SV. D=23**K=3/4
 IF WORKING_STEP==6   GOTOB ST6  ;T29.2(2/29) RAZVERTKA K=3/4
 IF WORKING_STEP==7   GOTOB ST7  ;T3.2(2/3) zenkovka d=10/90
 IF WORKING_STEP==8   GOTOB ST8  ;T28.2(2/28) METCIK K=3/4
 IF WORKING_STEP==9   GOTOB ST9  ;T10.2(2/10)REZEC D=34.4+0.17
 IF WORKING_STEP==10 GOTOB ST10  ;T9.1(1/9)REZEC D=39.5
 IF WORKING_STEP==11  GOTOB ST11 ;T14.2(2/14)FR.D=125/L=178-0.4
 IF WORKING_STEP==12  GOTOB ST12 ;T7.2(2/7)ZENKOVKA D=14<60
 IF WORKING_STEP==14  GOTOB ST14 ;T22.2(2/22)RAZ-KA D=40+0.062*
 IF WORKING_STEP==15  GOTOB ST15 ;T7(1/6)SVERLO D=16<90
 IF WORKING_STEP==16  GOTOB ST16 ;T29.1(1/29)SVERLO D=6.8
 IF WORKING_STEP==17  GOTOB ST17 ;T14.1(1/14)SVERLO D=10.2*
 IF WORKING_STEP==18  GOTOB ST18 ;T21.2(2/21)SVERLO D=11
 IF WORKING_STEP==19  GOTOB ST19 ;T25.1(1/25) SVERLO D=8.5
 IF WORKING_STEP==999  GOTOB ST999
ENDIF

AA: MSG("Neverniy etap obrabotki.Ti ne prav,poshevili mozgami!!!")
M0
GOTOB AA
CHECK_1:
GOTOB START_1
; NE UDOLAYT VSE RABOTAET
